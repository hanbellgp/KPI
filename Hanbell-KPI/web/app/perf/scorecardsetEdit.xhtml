<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../../WEB-INF/template.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <ui:define name="content">
        <h:form id="formOne">
            <p:growl id="growl"  showSummary="false" showDetail="true" />
            <p:toolbar id="toolbar" styleClass="topToolbar">
                <f:facet name="left">
                    <p:button id="btnReturn" value="返回" outcome="scorecardset" icon="ui-icon-restore"/>
                </f:facet>
                <f:facet name="right">
                    <p:commandButton id="btnCalc" value="得分" actionListener="#{scorecardSetManagedBean.calcScore()}" icon="ui-icon-check"
                                     rendered="#{!scorecardSetManagedBean.freezed}" process="@this" update="formOne">
                        <p:confirm header="系统提示" message="计算得分吗?" icon="ui-icon-alert" />
                    </p:commandButton>
                    <p:commandButton id="btnSave" value="保存" action="#{scorecardSetManagedBean.update()}" icon="ui-icon-save"
                                     process="@this,plgHead" update="formOne"/>
                </f:facet>
            </p:toolbar>
            <p:panelGrid id="plgHead" styleClass="plgHead Wid100">
                <f:facet name="header">
                    <p:row>
                        <p:column colspan="4">绩效考核－编辑</p:column>
                    </p:row>
                </f:facet>
                <p:row>
                    <p:column styleClass="Wid20"><p:outputLabel value="绩效名称" for="name" /></p:column>
                    <p:column styleClass="Wid30">
                        <p:inputText id="name" value="#{scorecardSetManagedBean.currentEntity.name}" title="Name"
                                     required="true" requiredMessage="请输入绩效名称"/>
                    </p:column>
                    <p:column styleClass="Wid20"><p:outputLabel value="绩效年度" for="seq" /></p:column>
                    <p:column styleClass="Wid30">
                        <p:inputText id="seq" value="#{scorecardSetManagedBean.currentEntity.seq}" title="seq"
                                     required="true" requiredMessage="请输入绩效年度"/>
                    </p:column>
                </p:row>
                <p:row>
                    <p:column><p:outputLabel value="绩效描述" for="descript" /></p:column>
                    <p:column colspan="3">
                        <p:inputText id="descript" value="#{scorecardSetManagedBean.currentEntity.descript}" title="descript" />
                    </p:column>
                </p:row>
                <p:row>
                    <p:column styleClass="Wid20"><p:outputLabel value="考核部门" for="deptno" /></p:column>
                    <p:column styleClass="Wid30">
                        <p:inputText id="deptno" value="#{scorecardSetManagedBean.currentEntity.deptno}" title="deptno"  styleClass="inputWithButton" readonly="true"
                                     required="true" requiredMessage="请输入考核部门"/>
                        <p:commandButton id="btnApplyDeptSelect" actionListener="#{scorecardSetManagedBean.openDialog('departmentSelect')}" icon="ui-icon-extlink"
                                         process="@this" >
                            <p:ajax event="dialogReturn" listener="#{scorecardSetManagedBean.handleDialogReturnWhenEdit}"
                                    update="deptno,deptname" />
                        </p:commandButton>
                    </p:column>
                    <p:column styleClass="Wid20"><p:outputLabel value="部门名称" for="deptname" /></p:column>
                    <p:column styleClass="Wid30">
                        <h:outputText id="deptname" value="#{scorecardSetManagedBean.currentEntity.deptname}" title="deptname" />
                    </p:column>
                </p:row>
                <p:row>
                    <p:column><p:outputLabel value="负责人员" for="userid" /></p:column>
                    <p:column>
                        <p:inputText id="userid" value="#{scorecardSetManagedBean.currentEntity.userid}" title="userid" styleClass="inputWithButton"
                                     />
                        <p:commandButton id="btnSystemUserSelect" actionListener="#{scorecardSetManagedBean.openDialog('sysuserSelect')}" icon="ui-icon-extlink"
                                         process="@this" >
                            <p:ajax event="dialogReturn" listener="#{scorecardSetManagedBean.handleDialogReturnUserWhenEdit}"
                                    process="@this" update="userid,username" />
                        </p:commandButton>
                    </p:column>
                    <p:column><h:outputText value="姓名"/></p:column>
                    <p:column>
                        <h:outputText id="username" value="#{scorecardSetManagedBean.currentEntity.username}" title="username" />
                    </p:column>
                </p:row>
                <p:row>
                    <p:column><p:outputLabel value="这是模板" for="template" /></p:column>
                    <p:column>
                        <p:inputSwitch id="template" value="#{scorecardSetManagedBean.currentEntity.template}"/>
                    </p:column>
                    <p:column><p:outputLabel value="使用模板" for="templateId" /></p:column>
                    <p:column>
                        <p:inputText id="templateId" value="#{scorecardSetManagedBean.currentEntity.templateId}" title="templateId" styleClass="inputWithButton"/>
                        <p:commandButton id="btnTemplateSelect" actionListener="#{scorecardSetManagedBean.openDialog('scoretemplateSelect')}" icon="ui-icon-extlink"
                                         process="@this">
                            <p:ajax event="dialogReturn" listener="#{scorecardSetManagedBean.handleDialogReturnTemplateWhenEdit}"
                                    process="@this"  update="formOne:tabView:tableList,templateId,api"/>
                        </p:commandButton>
                    </p:column>
                </p:row>
                <p:row>
                    <p:column><p:outputLabel value="API" for="api" /></p:column>
                    <p:column>
                        <p:inputText id="api" value="#{scorecardSetManagedBean.currentEntity.api}" title="API" required="true" />
                    </p:column>
                    <p:column><p:outputLabel value="菜单部门" for="menu" /></p:column>
                    <p:column>
                        <p:inputText id="menu" value="#{scorecardSetManagedBean.currentEntity.menu}" title="Menu" required="true" />
                    </p:column>
                </p:row>
                <p:row>
                    <p:column><p:outputLabel value="部门层级" for="lvl" /></p:column>
                    <p:column>
                        <p:selectOneMenu id="lvl" value="#{scorecardSetManagedBean.currentEntity.lvl}" title="Level"
                                         required="true" requiredMessage="请选择部门层级">
                            <f:selectItem itemLabel="部级" itemValue="D"/>
                            <f:selectItem itemLabel="课级" itemValue="S"/>
                        </p:selectOneMenu>
                    </p:column>
                    <p:column><p:outputLabel value="冻结日期" for="freezeDate" /></p:column>
                    <p:column>
                        <p:calendar id="freezeDate" value="#{scorecardSetManagedBean.currentEntity.freezeDate}" title="freezeDate"
                                    pattern="yyyy/MM/dd" />
                    </p:column> 
                </p:row>
                <p:row>
                    <p:column><p:outputLabel value="备注" for="remark" /></p:column>
                    <p:column>
                        <p:inputText id="remark" value="#{scorecardSetManagedBean.currentEntity.remark}" title="Remark" />
                    </p:column>
                    <p:column><p:outputLabel value="是否页面汇报" for="isbsc" /></p:column>
                    <p:column>
                        <p:inputSwitch id="isbsc" value="#{scorecardSetManagedBean.currentEntity.isbsc}"/>
                    </p:column>
                </p:row>
                <p:row>
                    <p:column styleClass="Wid20"><p:outputLabel value="Q1强制分数" for="lq1"/></p:column>
                    <p:column styleClass="Wid30">
                        <p:selectOneMenu id="lq1" value="#{scorecardSetManagedBean.currentEntity.lq1}" title="Q1强制分数" >
                            <f:selectItem itemLabel="" itemValue="0.00"/>
                            <f:selectItem itemLabel="特优" itemValue="95.00"/>
                            <f:selectItem itemLabel="优" itemValue="90.00"/>
                            <f:selectItem itemLabel="甲上" itemValue="85.00"/>
                            <f:selectItem itemLabel="甲" itemValue="80.00"/>
                            <f:selectItem itemLabel="乙" itemValue="75.00"/>
                        </p:selectOneMenu>
                    </p:column>
                    <p:column styleClass="Wid20"><p:outputLabel value="Q2强制分数" for="lq2"/></p:column>
                    <p:column styleClass="Wid30">
                        <p:selectOneMenu id="lq2" value="#{scorecardSetManagedBean.currentEntity.lq2}" title="Q2强制分数" >
                            <f:selectItem itemLabel="" itemValue="0.00"/>
                            <f:selectItem itemLabel="特优" itemValue="95.00"/>
                            <f:selectItem itemLabel="优" itemValue="90.00"/>
                            <f:selectItem itemLabel="甲上" itemValue="85.00"/>
                            <f:selectItem itemLabel="甲" itemValue="80.00"/>
                            <f:selectItem itemLabel="乙" itemValue="75.00"/>
                        </p:selectOneMenu>
                    </p:column>
                </p:row>
                <p:row>
                    <p:column styleClass="Wid20"><p:outputLabel value="Q3强制分数" for="lq3"/></p:column>
                    <p:column styleClass="Wid30">
                        <p:selectOneMenu id="lq3" value="#{scorecardSetManagedBean.currentEntity.lq3}" title="Q3强制分数" >
                            <f:selectItem itemLabel="" itemValue="0.00"/>
                                  <f:selectItem itemLabel="特优" itemValue="95.00"/>
                            <f:selectItem itemLabel="优" itemValue="90.00"/>
                            <f:selectItem itemLabel="甲上" itemValue="85.00"/>
                            <f:selectItem itemLabel="甲" itemValue="80.00"/>
                            <f:selectItem itemLabel="乙" itemValue="75.00"/>
                        </p:selectOneMenu>
                    </p:column>
                    <p:column styleClass="Wid20"><p:outputLabel value="Q4强制分数" for="lq4"/></p:column>
                    <p:column styleClass="Wid30">
                        <p:selectOneMenu id="lq4" value="#{scorecardSetManagedBean.currentEntity.lq4}" title="Q4强制分数" >
                            <f:selectItem itemLabel="" itemValue="0.00"/>
                                      <f:selectItem itemLabel="特优" itemValue="95.00"/>
                            <f:selectItem itemLabel="优" itemValue="90.00"/>
                            <f:selectItem itemLabel="甲上" itemValue="85.00"/>
                            <f:selectItem itemLabel="甲" itemValue="80.00"/>
                            <f:selectItem itemLabel="乙" itemValue="75.00"/>
                        </p:selectOneMenu>
                    </p:column>
                </p:row>
            </p:panelGrid>
            <p:panelGrid id="plgScore" styleClass="plgHead Wid100" style="text-align: right">
                <p:row>
                    <p:column styleClass="Wid15"><h:outputText value="Q1得分"/></p:column>
                    <p:column styleClass="Wid15"><h:outputText value="Q2得分"/></p:column>
                    <p:column styleClass="Wid20"><h:outputText value="上半年得分"/></p:column>
                    <p:column styleClass="Wid15"><h:outputText value="Q3得分"/></p:column>
                    <p:column styleClass="Wid15"><h:outputText value="Q4得分"/></p:column>
                    <p:column styleClass="Wid20"><h:outputText value="全年得分"/></p:column>
                </p:row>
                <p:row>
                    <p:column>
                        <h:outputText id="sq1" value="#{scorecardSetManagedBean.currentEntity.sq1}" title="sq1"/>
                    </p:column>
                    <p:column>
                        <h:outputText id="sq2" value="#{scorecardSetManagedBean.currentEntity.sq2}" title="sq2"/>
                    </p:column>
                    <p:column>
                        <h:outputText id="sh1" value="#{scorecardSetManagedBean.currentEntity.sh1}" title="sh1"/>
                    </p:column>
                    <p:column>
                        <h:outputText id="sq3" value="#{scorecardSetManagedBean.currentEntity.sq3}" title="sq3"/>
                    </p:column>
                    <p:column>
                        <h:outputText id="sq4" value="#{scorecardSetManagedBean.currentEntity.sq4}" title="sq4"/>
                    </p:column>
                    <p:column>
                        <h:outputText id="sfy" value="#{scorecardSetManagedBean.currentEntity.sfy}" title="sfy"/>
                    </p:column>
                </p:row>
            </p:panelGrid>
            <p:tabView id="tabView" styleClass="tabView">
                <p:tab title="考核明细">
                    <p:toolbar id="detailToolbar" styleClass="detailToolbar">
                        <f:facet name="left">
                            <p:commandButton id="btnAddDetail" widgetVar="btnAddDetail" value="添加" actionListener="#{scorecardSetManagedBean.createDetail()}" icon="ui-icon-plus"
                                             oncomplete="PF('btnAddDetail').disable();PF('btnDeleteDetail').disable();PF('btnSaveDetail').enable();"
                                             process="@this" update=":formOne:tabView:plgDetail,:formOne:dlgStageDescription"/>
                            <p:commandButton id="btnDeleteDetail" widgetVar="btnDeleteDetail" value="删除" actionListener="#{scorecardSetManagedBean.deleteDetail()}" icon="ui-icon-trash"
                                             oncomplete="PF('btnAddDetail').enable();PF('btnDeleteDetail').disable();PF('btnSaveDetail').disable();"
                                             process="@this" update=":formOne:tabView:plgDetail,:formOne:tabView:tableList" />

                        </f:facet>
                        <f:facet name="right">
                            <p:commandButton id="btnFillDetail" widgetVar="btnFillDetail" value="填报"  icon="ui-icon-plus"
                                             process="@this" update="formOne:dlgDetail,formOne:dlgStageDescription" oncomplete="PF('dlgDetail').show();">
                            </p:commandButton>
                            <p:commandButton id="btnSaveDetail" widgetVar="btnSaveDetail" value="确定" actionListener="#{scorecardSetManagedBean.doConfirmDetail()}" icon="ui-icon-check"
                                             onsuccess="PF('btnAddDetail').enable();PF('btnDeleteDetail').disable();PF('btnSaveDetail').disable();"
                                             
                                             process="@this,formOne:tabView:plgDetail" 
                                             update="formOne:tabView:plgDetail,formOne:tabView:tableList,formOne:dlgStageDescription,formOne:growl"/>

                            <script type="text/javascript">
                                function handleSuccess() {
                                    alert('操作成功！');
                                }
                            </script>
                            <p:commandButton id="btnImportByPolicyDetail" widgetVar="btnImportByPolicyDetail" value="方针导入" icon="ui-icon-note" actionListener="#{scorecardSetManagedBean.openDialog('policySelect')}"
                                             oncomplete="PF('btnAddDetail').disable();PF('btnDeleteDetail').disable();PF('btnSaveDetail').enable();"  process="@this"  >
                                <p:ajax event="dialogReturn" listener="#{scorecardSetManagedBean.handleDialogReturnWhenPolicySelect}"
                                        process="@this" update="formOne:tabView:plgDetail,formOne:tabView:tableList,formOne:dlgStageDescription,formOne:growl"/>
                            </p:commandButton>

                        </f:facet>
                    </p:toolbar>
                    <p:panelGrid id="plgDetail"  styleClass="plgDetail Wid100">
                        <p:row>
                            <p:column styleClass="Wid20"><p:outputLabel value="考核内容" for="content" /></p:column>
                            <p:column styleClass="Wid30">
                                <p:inputText id="content" value="#{scorecardSetManagedBean.currentDetail.content}" title="content"
                                            />
                            </p:column>
                            <p:column styleClass="Wid20"><p:outputLabel value="权重" for="weight" /></p:column>
                            <p:column styleClass="Wid30">
                                <p:spinner id="weight" value="#{scorecardSetManagedBean.currentDetail.weight}" title="weight" stepFactor="0.5"
                                          />
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="指标类型" for="type"/></p:column>
                            <p:column>
                                <p:selectOneMenu id="type" value="#{scorecardSetManagedBean.currentDetail.type}" title="type">
                                    <f:selectItem itemLabel="数字" itemValue="N"/>
                                    <f:selectItem itemLabel="文字" itemValue="S"/>
                                    <f:selectItem itemLabel="时间" itemValue="T"/>
                                    <f:ajax execute="@this" />
                                </p:selectOneMenu>
                            </p:column>
                            <p:column><p:outputLabel value="计算周期"  for="kind"/></p:column>
                            <p:column>
                                <p:selectOneMenu id="kind" value="#{scorecardSetManagedBean.currentDetail.kind}" title="kind"
                                               disabled="false">
                                    <f:selectItem itemLabel="季" itemValue="Q"/>
                                </p:selectOneMenu>
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="计算方式" for="valuemode" /></p:column>
                            <p:column>
                                <p:selectOneMenu id="valuemode" value="#{scorecardSetManagedBean.currentDetail.valueMode}" title="valuemode"
                                              >
                                    <f:selectItem itemLabel="手动输入" itemValue="I"/>
                                    <f:selectItem itemLabel="求和" itemValue="S"/>
                                    <f:selectItem itemLabel="平均值" itemValue="A"/>
                                    <f:selectItem itemLabel="表达式" itemValue="E"/>
                                </p:selectOneMenu>
                            </p:column>
                            <p:column><p:outputLabel value="单位" for="unit" /></p:column>
                            <p:column>
                                <p:inputText id="unit" value="#{scorecardSetManagedBean.currentDetail.unit}" title="unit" />
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="参考KPI" for="indicator" /></p:column>
                            <p:column>
                                <p:inputText id="indicator" value="#{scorecardSetManagedBean.currentDetail.indicator}" title="deptno"  styleClass="inputWithButton" readonly="true"/>
                                <p:commandButton id="btnIndicatorSelect" actionListener="#{scorecardSetManagedBean.openDialog('indicatorSelect')}" icon="ui-icon-extlink"
                                                 process="@this" >
                                    <p:ajax event="dialogReturn" listener="#{scorecardSetManagedBean.handleDialogReturnWhenDetailEdit}"
                                            update="indicator,indicatorDeptno,indicatorDeptname" />
                                </p:commandButton>
                            </p:column>
                            <p:column><p:outputLabel value="数字格式" for="symbol" /></p:column>
                            <p:column>
                                <p:inputText id="symbol" value="#{scorecardSetManagedBean.currentDetail.symbol}" title="symbol" />
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="PLM编号" for="projectSeq" /></p:column>
                            <p:column>
                                <p:inputText id="projectSeq" value="#{scorecardSetManagedBean.currentDetail.projectSeq}" title="projectSeq"  styleClass="inputWithButton" />
                                <p:commandButton id="btnProjectSelect" actionListener="#{scorecardSetManagedBean.openDialog('projectSelect')}" icon="ui-icon-extlink"
                                                 process="@this type" >
                                    <p:ajax event="dialogReturn" listener="#{scorecardSetManagedBean.handleDialogReturnDeptWhenProjectNew}"
                                            update="projectSeq,projectName,formOne:growl" />
                                </p:commandButton>
                            </p:column>
                            <p:column><p:outputLabel value="PLM名称" for="projectName" /></p:column>
                            <p:column>
                                <p:inputText id="projectName" value="#{scorecardSetManagedBean.currentDetail.projectName}" title="projectName" />
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="方针编号" for="policySeq" /></p:column>
                            <p:column>
                                <p:inputText id="policySeq" value="#{scorecardSetManagedBean.currentDetail.policySeq}" title="policySeq"  styleClass="inputWithButton" readonly="true"/>
                                <p:commandButton id="btnPolicySelect" actionListener="#{scorecardSetManagedBean.openDialog('policySelect')}" icon="ui-icon-extlink"
                                                 process="@form" >
                                    <p:ajax event="dialogReturn" listener="#{scorecardSetManagedBean.handleDialogReturnDeptWhenPolicyNew}"
                                            update="policySeq,policyName,formOne:growl" />
                                </p:commandButton>
                            </p:column>
                            <p:column><p:outputLabel value="方针名称" for="policyName" /></p:column>
                            <p:column>
                                <p:inputText id="policyName" value="#{scorecardSetManagedBean.currentDetail.policyName}" title="policyName" />
                            </p:column>
                        </p:row>

                        <p:row>
                            <p:column><p:outputLabel value="考核对象" for="indicatorDeptno" /></p:column>
                            <p:column>
                                <p:inputText id="indicatorDeptno" value="#{scorecardSetManagedBean.currentDetail.deptno}" title="indicatorDeptno"
                                             styleClass="inputWithButton" readonly="true"/>
                                <p:commandButton id="btnIndicatorDeptSelect" actionListener="#{scorecardSetManagedBean.openDialog('departmentSelect')}" icon="ui-icon-extlink"
                                                 process="@form" >
                                    <p:ajax event="dialogReturn" listener="#{scorecardSetManagedBean.handleDialogReturnDeptWhenDetailEdit}"
                                            update="indicatorDeptno,indicatorDeptname" />
                                </p:commandButton>
                            </p:column>
                            <p:column><p:outputLabel value="对象名称" for="indicatorDeptname" /></p:column>
                            <p:column>
                                <h:outputText id="indicatorDeptname" value="#{scorecardSetManagedBean.currentDetail.deptname}" title="indicatorDeptname" />
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="最低分" for="minNum" /></p:column>
                            <p:column>
                                <p:spinner id="minNum" value="#{scorecardSetManagedBean.currentDetail.minNum}" title="minNum"/>
                            </p:column>
                            <p:column><p:outputLabel value="最高分" for="maxNum" /></p:column>
                            <p:column>
                                <p:spinner id="maxNum" value="#{scorecardSetManagedBean.currentDetail.maxNum}" title="maxNum"/>
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="换算率" for="rate" /></p:column>
                            <p:column>
                                <p:inputNumber id="rate" value="#{scorecardSetManagedBean.currentDetail.rate}" title="rate" />
                            </p:column>
                            <p:column><p:outputLabel value="排序" for="seq"  /></p:column>
                            <p:column>
                                <p:inputNumber id="seq" value="#{scorecardSetManagedBean.currentDetail.seq}" title="seq" />
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column><p:outputLabel value="公式名称" for="jexlName" /></p:column>
                            <p:column colspan="3">
                                <p:selectOneMenu id="jexlName" value="#{scorecardSetManagedBean.currentDetail.jexlName}" title="jexlName" >
                                    <f:selectItem itemLabel="" itemValue="0"/>
                                    <f:selectItem itemLabel="1、销售台数、销售金额、维修台数、收费服务金额、培训学分达成率、预算控制达成率；" itemValue="1"/>
                                    <f:selectItem itemLabel="2、员工离职率；" itemValue="2"/>
                                    <f:selectItem itemLabel="3、品质相关指标（合格率/良率/不良率等等）、客诉、上线欠料、平均交货延迟天数/交货及时率、万元产值能耗、综合效率（工时等），越大越好；" itemValue="3"/>
                                    <f:selectItem itemLabel="4、品质相关指标（合格率/良率/不良率等等）、客诉、上线欠料、平均交货延迟天数/交货及时率、万元产值能耗、综合效率（工时等），越小越好；" itemValue="4"/>
                                    <f:selectItem itemLabel="5、其他，越大越好；" itemValue="5"/>
                                    <f:selectItem itemLabel="6、其他，越小越好；" itemValue="6"/>   
                                    <p:ajax event="itemSelect" listener="#{scorecardSetManagedBean.onItemSelectedListener}"   update="performanceJexl,scoreJexl" />
                                </p:selectOneMenu>
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column><h:outputText value="达成公式"/></p:column>
                            <p:column colspan="3">
                                <p:inputTextarea id="performanceJexl" value="#{scorecardSetManagedBean.currentDetail.performanceJexl}" title="performanceJexl" styleClass="Wid100"/>
                            </p:column>
                        </p:row>
                        <p:row >
                            <p:column><p:outputLabel value="得分公式" for="scoreJexl" /></p:column>
                            <p:column colspan="3">
                                <p:inputTextarea id="scoreJexl" value="#{scorecardSetManagedBean.currentDetail.scoreJexl}" title="scoreJexl" styleClass="Wid100"/>
                            </p:column>
                        </p:row>
                    </p:panelGrid>
                    <p:dataTable id="tableList" value="#{scorecardSetManagedBean.detailList}" var="item" styleClass="tableList Mtop10"
                                 selectionMode="single" selection="#{scorecardSetManagedBean.currentDetail}" rowKey="#{item.seq}" >
                        <p:ajax event="rowSelect" update="formOne:tabView:plgDetail,formOne:dlgStageDescription" 
                                oncomplete="PF('btnAddDetail').enable();PF('btnDeleteDetail').enable();PF('btnSaveDetail').enable();"  />
                        <p:ajax event="rowUnselect" update=":formOne:tabView:plgDetail" oncomplete="" />
                        <p:ajax event="rowDblselect" update="formOne:dlgDetail" oncomplete="PF('dlgDetail').show();"/>
                        
                        <p:column styleClass="Wid30">
                            <f:facet name="header">
                                <h:outputText value="考核内容"/>
                            </f:facet>
                            <p:graphicImage name="images/K.png" library="ultima-layout" style="height:20px;width:20px;background-color: #EEE8AA" rendered="#{item.indicator!='' and item.indicator!=null}"/>
                            <p:graphicImage name="images/P.png" library="ultima-layout" style="height:20px;width:20px;background-color: #EEE8AA" rendered="#{item.projectSeq!='' and item.projectSeq!=null}"/>
                            <p:graphicImage name="images/F.png" library="ultima-layout" style="height:20px;width:20px;background-color: #EEE8AA" rendered="#{item.policySeq!='' and item.policySeq!=null}"/>
                            <h:outputText value="#{item.content}"></h:outputText>
                        </p:column>
                        <p:column style="text-align: right">
                            <f:facet name="header">
                                <h:outputText value="权重"/>
                            </f:facet>
                            <h:outputText value="#{item.weight}"/>
                        </p:column>
                        <p:column style="text-align: right">
                            <f:facet name="header">
                                <h:outputText value="Q1达成"/>
                            </f:facet>
                            <h:outputText value="#{item.pq1}" style="#{(item.pq1 &lt; 100 and item.pq1 &gt; 0)?'color:red':'' }" />
                        </p:column>
                        <p:column style="text-align: right">
                            <f:facet name="header">
                                <h:outputText value="Q1得分"/>
                            </f:facet>
                            <h:outputText value="#{item.sq1}"/>
                        </p:column>
                        <p:column style="text-align: right">
                            <f:facet name="header">
                                <h:outputText value="Q2达成"/>
                            </f:facet>
                            <h:outputText value="#{item.pq2}" style="#{(item.pq2 &lt; 100 and item.pq2 &gt; 0)?'color:red':'' }"/>
                        </p:column>
                        <p:column style="text-align: right">
                            <f:facet name="header">
                                <h:outputText value="Q2得分"/>
                            </f:facet>
                            <h:outputText value="#{item.sq2}"/>
                        </p:column>
                        <p:column style="text-align: right">
                            <f:facet name="header">
                                <h:outputText value="HY达成"/>
                            </f:facet>
                            <h:outputText value="#{item.ph1}" style="#{(item.ph1 &lt; 100 and item.ph1 &gt; 0)?'color:red':'' }"/>
                        </p:column>
                        <p:column style="text-align: right">
                            <f:facet name="header">
                                <h:outputText value="HY得分"/>
                            </f:facet>
                            <h:outputText value="#{item.sh1}"/>
                        </p:column>
                        <p:column style="text-align: right">
                            <f:facet name="header">
                                <h:outputText value="Q3达成"/>
                            </f:facet>
                            <h:outputText value="#{item.pq3}" style="#{(item.pq3 &lt; 100 and item.pq3 &gt; 0)?'color:red':'' }"/>
                        </p:column>
                        <p:column style="text-align: right">
                            <f:facet name="header">
                                <h:outputText value="Q3得分"/>
                            </f:facet>
                            <h:outputText value="#{item.sq3}"/>
                        </p:column>
                        <p:column style="text-align: right">
                            <f:facet name="header">
                                <h:outputText value="Q4达成"/>
                            </f:facet>
                            <h:outputText value="#{item.pq4}" style="#{(item.pq4 &lt; 100 and item.pq4 &gt; 0)?'color:red':'' }"/>
                        </p:column>
                        <p:column style="text-align: right">
                            <f:facet name="header">
                                <h:outputText value="Q4得分"/>
                            </f:facet>
                            <h:outputText value="#{item.sq4}"/>
                        </p:column>
            
                    </p:dataTable>
                    <p:contextMenu id="contextMenu" for="tableList">
                        <p:menuitem value="向上" icon="arrow-upward" actionListener="#{scorecardSetManagedBean.moveUp}"  process="@this,formOne:tabView" 
                                    update="formOne:tabView:plgDetail,formOne:tabView:contextMenu,formOne:dlgStageDescription,tableList" />
                        <p:menuitem value="向下" icon="arrow-downward" actionListener="#{scorecardSetManagedBean.moveDown}" process="@this,formOne:tabView" 
                                   update="formOne:tabView:plgDetail,formOne:tabView:contextMenu,formOne:dlgStageDescription,tableList" />
                    </p:contextMenu>
                </p:tab>
            </p:tabView>
            <p:dialog id="dlgDetail" widgetVar="dlgDetail"  height="650" width="90%" style="text-align: center"
                      header="当前是#{scorecardSetManagedBean.userManagedBean.y}年第#{scorecardSetManagedBean.userManagedBean.q}季度绩效考核，#{scorecardSetManagedBean.currentDetail.content} 权重 #{scorecardSetManagedBean.currentDetail.weight}" blockScroll="false">
                <p:panelGrid id="plgFillDetail"  styleClass="plgDetail Wid100">
                    <f:facet name="header">
                        <p:row>
                            <p:column styleClass="Wid5"><p:outputLabel value="期间"/></p:column>
                            <p:column styleClass="Wid15" colspan="2"><p:outputLabel value="基准或目标"/></p:column>
                            <p:column styleClass="Wid15"><p:outputLabel value="实际"/></p:column>
                            <p:column><p:outputLabel value="达成"/></p:column>
                            <p:column styleClass="Wid15"><p:outputLabel value="部门说明"/></p:column>
                            <p:column><p:outputLabel value="自评得分"/></p:column>
                            <p:column styleClass="Wid15"><p:outputLabel value="总经理说明"/></p:column>
                            <p:column><p:outputLabel value="最终得分"/></p:column>
                            <p:column><p:outputLabel value="系数"/></p:column>
                        </p:row>
                    </f:facet>
                    <p:row>
                        <p:column><p:outputLabel value="Q1"/></p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}">
                            <p:inputNumber id="bq1n" value="#{scorecardSetManagedBean.currentDetail.bq1}" styleClass="Wid100"  title="bq1" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}">
                            <p:inputNumber id="tq1n" value="#{scorecardSetManagedBean.currentDetail.tq1}" styleClass="Wid100"  title="tq1" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}">
                            <p:inputTextarea id="bq1n1" value="#{scorecardSetManagedBean.currentDetail.bq1}" styleClass="Wid100"  title="bq1" rows="5"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}">
                            <p:inputTextarea id="tq1n1" value="#{scorecardSetManagedBean.currentDetail.tq1}" styleClass="Wid100"  title="tq1" rows="5"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="aq1" value="#{scorecardSetManagedBean.currentDetail.aq1}" rows="5" styleClass="Wid100"  title="aq1" rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}"/>
                            <p:inputNumber id="aq1n" value="#{scorecardSetManagedBean.currentDetail.aq1}" styleClass="Wid100"  title="aq1" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero" rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}" />
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:inputNumber id="pq1" value="#{scorecardSetManagedBean.currentDetail.pq1}" title="pq1"
                                           symbol="%" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="dq1" value="#{scorecardSetManagedBean.currentDetail.deptScore.q1}" rows="5" styleClass="Wid100"  title="dq1"/>
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:inputText id="dsq1" value="#{scorecardSetManagedBean.currentDetail.deptScore.sq1}" title="dsq1" style="text-align: right"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="gq1" value="#{scorecardSetManagedBean.currentDetail.generalScore.q1}" rows="5" styleClass="Wid100"  title="gq1"/>
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:inputText id="gsq1" value="#{scorecardSetManagedBean.currentDetail.generalScore.sq1}" title="gsq1" style="text-align: right"/>
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:spinner id="cq1" value="#{scorecardSetManagedBean.currentDetail.cq1}"  stepFactor="0.10" title="cq1">
                                <p:ajax listener="#{scorecardSetManagedBean.calcItemScore()}" process="@this,cq1" update="gsq1,dsq1" />
                            </p:spinner>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column><p:outputLabel value="Q2"/></p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}">
                            <p:inputNumber id="bq2n" value="#{scorecardSetManagedBean.currentDetail.bq2}" styleClass="Wid100"  title="bq2" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}">
                            <p:inputNumber id="tq2n" value="#{scorecardSetManagedBean.currentDetail.tq2}" styleClass="Wid100"  title="tq2" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}">
                            <p:inputTextarea id="bq2n1" value="#{scorecardSetManagedBean.currentDetail.bq2}" styleClass="Wid100"  title="bq2" rows="5" />
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}">
                            <p:inputTextarea id="tq2n1" value="#{scorecardSetManagedBean.currentDetail.tq2}" styleClass="Wid100"  title="tq2" rows="5" />
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="aq2" value="#{scorecardSetManagedBean.currentDetail.aq2}" rows="5" styleClass="Wid100"  title="aq2" rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}"/>
                            <p:inputNumber id="aq2n" value="#{scorecardSetManagedBean.currentDetail.aq2}" styleClass="Wid100"  title="aq2" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero" rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}"/>
                        </p:column>
                        <p:column styleClass="Wid5" style="text-align: right">
                            <p:inputNumber id="pq2" value="#{scorecardSetManagedBean.currentDetail.pq2}" title="pq2"
                                           symbol="%" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="dq2" value="#{scorecardSetManagedBean.currentDetail.deptScore.q2}" rows="5" styleClass="Wid100"  title="dq2" />
                        </p:column>
                        <p:column styleClass="Wid5" >
                            <p:inputText id="dsq2" value="#{scorecardSetManagedBean.currentDetail.deptScore.sq2}" title="dsq2" style="text-align: right"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="gq2" value="#{scorecardSetManagedBean.currentDetail.generalScore.q2}" rows="5" styleClass="Wid100"  title="gq2" />
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:inputText id="gsq2" value="#{scorecardSetManagedBean.currentDetail.generalScore.sq2}" title="gsq2"  style="text-align: right"/>
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:spinner id="cq2" value="#{scorecardSetManagedBean.currentDetail.cq2}"  stepFactor="0.10" title="cq2">
                                <p:ajax listener="#{scorecardSetManagedBean.calcItemScore()}" process="@this,cq2" update="gsq2,gsh1,dsq2,dsh1" />
                            </p:spinner>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column><p:outputLabel value="上半年"/></p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}">
                            <p:inputNumber id="bh1n" value="#{scorecardSetManagedBean.currentDetail.bh1}" styleClass="Wid100"  title="bh1" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}">
                            <p:inputNumber id="th1n" value="#{scorecardSetManagedBean.currentDetail.th1}" styleClass="Wid100"  title="th1" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}">
                            <p:inputTextarea id="bh1n1" value="#{scorecardSetManagedBean.currentDetail.bh1}" styleClass="Wid100"  title="bh1" rows="5"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}">
                            <p:inputTextarea id="th1n1" value="#{scorecardSetManagedBean.currentDetail.th1}" styleClass="Wid100"  title="th1" rows="5"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="ah1" value="#{scorecardSetManagedBean.currentDetail.ah1}" rows="5" styleClass="Wid100"  title="ah1" rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}"/>
                            <p:inputNumber id="ah1n" value="#{scorecardSetManagedBean.currentDetail.ah1}" styleClass="Wid100"  title="ah1" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero" rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}"/>
                        </p:column>
                        <p:column styleClass="Wid5" style="text-align: right">
                            <p:inputNumber id="ph1" value="#{scorecardSetManagedBean.currentDetail.ph1}" title="ph1"
                                           symbol="%" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="dh1" value="#{scorecardSetManagedBean.currentDetail.deptScore.h1}" rows="5" styleClass="Wid100"  title="dh1" />
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:inputText id="dsh1" value="#{scorecardSetManagedBean.currentDetail.deptScore.sh1}" title="dsh1"  style="text-align: right"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="gh1" value="#{scorecardSetManagedBean.currentDetail.generalScore.h1}" rows="5" styleClass="Wid100"  title="gh1" />
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:inputText id="gsh1" value="#{scorecardSetManagedBean.currentDetail.generalScore.sh1}" title="gsh1"  style="text-align: right"/>
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:spinner id="ch1" value="#{scorecardSetManagedBean.currentDetail.ch1}"  stepFactor="0.10" title="ch1">
                                <p:ajax listener="#{scorecardSetManagedBean.calcItemScore()}" process="@this,ch1" update="gsh1,dsh1" />
                            </p:spinner>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column><p:outputLabel value="Q3"/></p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}">
                            <p:inputNumber id="bq3n" value="#{scorecardSetManagedBean.currentDetail.bq3}" styleClass="Wid100"  title="bq3" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}">
                            <p:inputNumber id="tq3n" value="#{scorecardSetManagedBean.currentDetail.tq3}" styleClass="Wid100"  title="tq3" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero"/>
                        </p:column>

                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}">
                            <p:inputTextarea id="bq3n1" value="#{scorecardSetManagedBean.currentDetail.bq3}" styleClass="Wid100"  title="bq3" rows="5" />
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}">
                            <p:inputTextarea id="tq3n1" value="#{scorecardSetManagedBean.currentDetail.tq3}" styleClass="Wid100"  title="tq3" rows="5" />
                        </p:column>

                        <p:column>
                            <p:inputTextarea id="aq3" value="#{scorecardSetManagedBean.currentDetail.aq3}"  rows="5" styleClass="Wid100"  title="aq3" rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}"/>
                            <p:inputNumber id="aq3n" value="#{scorecardSetManagedBean.currentDetail.aq3}" styleClass="Wid100"  title="aq3" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero" rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}"/>
                        </p:column>
                        <p:column styleClass="Wid5" style="text-align: right">
                            <p:inputNumber id="pq3" value="#{scorecardSetManagedBean.currentDetail.pq3}" title="pq3"
                                           symbol="%" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="dq3" value="#{scorecardSetManagedBean.currentDetail.deptScore.q3}"  rows="5" styleClass="Wid100"  title="dq3" />
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:inputText id="dsq3" value="#{scorecardSetManagedBean.currentDetail.deptScore.sq3}" title="dsq3" style="text-align: right"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="gq3" value="#{scorecardSetManagedBean.currentDetail.generalScore.q3}"  rows="5" styleClass="Wid100"  title="gq3" />
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:inputText id="gsq3" value="#{scorecardSetManagedBean.currentDetail.generalScore.sq3}" title="gsq3" style="text-align: right"/>
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:spinner id="cq3" value="#{scorecardSetManagedBean.currentDetail.cq3}"  stepFactor="0.10" title="cq3">
                                <p:ajax listener="#{scorecardSetManagedBean.calcItemScore()}" process="@this,cq3" update="gsq3,dsq3" />
                            </p:spinner>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column><p:outputLabel value="Q4"/></p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}">
                            <p:inputNumber id="bq4n" value="#{scorecardSetManagedBean.currentDetail.bq4}" styleClass="Wid100"  title="bq4" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}">
                            <p:inputNumber id="tq4n" value="#{scorecardSetManagedBean.currentDetail.tq4}" styleClass="Wid100"  title="tq4" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}">
                            <p:inputTextarea id="bq4n1" value="#{scorecardSetManagedBean.currentDetail.bq4}" styleClass="Wid100"  title="bq4"   rows="5"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}">
                            <p:inputTextarea id="tq4n1" value="#{scorecardSetManagedBean.currentDetail.tq4}" styleClass="Wid100"  title="tq4"  rows="5"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="aq4" value="#{scorecardSetManagedBean.currentDetail.aq4}" rows="5" styleClass="Wid100"  title="aq4" rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}"/>
                            <p:inputNumber id="aq4n" value="#{scorecardSetManagedBean.currentDetail.aq4}" styleClass="Wid100"  title="aq4" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero" rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}"/>
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:inputNumber id="pq4" value="#{scorecardSetManagedBean.currentDetail.pq4}" title="pq4"
                                           symbol="%" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="dq4" value="#{scorecardSetManagedBean.currentDetail.deptScore.q4}" rows="5"  styleClass="Wid100"  title="dq4" />
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:inputText id="dsq4" value="#{scorecardSetManagedBean.currentDetail.deptScore.sq4}" title="dsq4"  style="text-align: right"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="gq4" value="#{scorecardSetManagedBean.currentDetail.generalScore.q4}" rows="5"  styleClass="Wid100"  title="gq4" />
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:inputText id="gsq4" value="#{scorecardSetManagedBean.currentDetail.generalScore.sq4}" title="gsq4" style="text-align: right"/>
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:spinner id="cq4" value="#{scorecardSetManagedBean.currentDetail.cq4}"  stepFactor="0.10" title="cq4">
                                <p:ajax listener="#{scorecardSetManagedBean.calcItemScore()}" process="@this,cq4" update="gsq4,gsfy,dsq4,dsfy" />
                            </p:spinner>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column><p:outputLabel value="全年"/></p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}">
                            <p:inputNumber id="bfyn" value="#{scorecardSetManagedBean.currentDetail.bfy}" styleClass="Wid100"  title="bfy" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}">
                            <p:inputNumber id="tfyn" value="#{scorecardSetManagedBean.currentDetail.tfy}" styleClass="Wid100"  title="tfy" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}">
                            <p:inputTextarea id="bfyn1" value="#{scorecardSetManagedBean.currentDetail.bfy}" styleClass="Wid100"  title="bfy"  rows="5" />
                        </p:column>
                        <p:column rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}">
                            <p:inputTextarea id="tfyn1" value="#{scorecardSetManagedBean.currentDetail.tfy}" styleClass="Wid100"  title="tfy"  rows="5" />
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="afy" value="#{scorecardSetManagedBean.currentDetail.afy}"  rows="5" styleClass="Wid100"  title="afy" rendered="#{scorecardSetManagedBean.currentDetail.type!='N'}"/>
                            <p:inputNumber id="afyn" value="#{scorecardSetManagedBean.currentDetail.afy}" styleClass="Wid100"  title="afy" decimalPlaces="3"
                                           symbol="#{scorecardSetManagedBean.currentDetail.symbol}" symbolPosition="s" emptyValue="zero" rendered="#{scorecardSetManagedBean.currentDetail.type=='N'}"/>
                        </p:column>
                        <p:column styleClass="Wid5" style="text-align: right">
                            <p:inputNumber id="pfy" value="#{scorecardSetManagedBean.currentDetail.pfy}" title="pfy"
                                           symbol="%" symbolPosition="s" emptyValue="zero"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="dfy" value="#{scorecardSetManagedBean.currentDetail.deptScore.fy}" rows="5" styleClass="Wid100"  title="dfy" />
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:inputText id="dsfy" value="#{scorecardSetManagedBean.currentDetail.deptScore.sfy}" title="dsfy" style="text-align: right"/>
                        </p:column>
                        <p:column>
                            <p:inputTextarea id="gfy" value="#{scorecardSetManagedBean.currentDetail.generalScore.fy}" rows="5" styleClass="Wid100"  title="gfy" />
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:inputText id="gsfy" value="#{scorecardSetManagedBean.currentDetail.generalScore.sfy}" title="gsfy" style="text-align: right"/>
                        </p:column>
                        <p:column styleClass="Wid5">
                            <p:spinner id="cfy" value="#{scorecardSetManagedBean.currentDetail.cfy}"  stepFactor="0.10" title="cfy">
                                <p:ajax listener="#{scorecardSetManagedBean.calcItemScore()}" process="@this,cfy" update="gsfy,dsfy" />
                            </p:spinner>
                        </p:column>
                    </p:row>
                    <f:facet name="footer">
                        <p:row>
                            <p:column colspan="10">
                                <p:commandButton id="btnSaveExplanation" value="确定"  actionListener="#{scorecardSetManagedBean.doConfirmDetail()}" icon="ui-icon-save" style="float: right"
                                                 process="@this,formOne:dlgDetail" update="formOne:tabView" oncomplete="PF('dlgDetail').hide();PF('btnSaveDetail').disable();" >
                                </p:commandButton>
                                <p:commandButton id="btnCalcItemScore" value="得分"  actionListener="#{scorecardSetManagedBean.calcItemScore()}" icon="ui-icon-sync" style="float: right"
                                                 process="@this,formOne:dlgDetail" update="formOne:tabView:tableList,formOne:dlgDetail,growl" oncomplete="PF('dlgDetail').hide();PF('dlgDetail').show();">
                                </p:commandButton>
                                <p:commandButton id="btnUpdate" value="更新"  actionListener="#{scorecardSetManagedBean.updateActual()}" icon="ui-icon-pencil" style="float: right"
                                                 process="@this,formOne:dlgDetail" update="formOne:tabView:tableList,formOne:dlgDetail,growl" oncomplete="PF('dlgDetail').hide();PF('dlgDetail').show();">
                                </p:commandButton>
                                <p:commandButton value="阶段说明" type="button" onclick="PF('dlgStageDescription').show();" icon="ui-icon-search" />
                            </p:column>
                        </p:row>
                    </f:facet>
                </p:panelGrid>
            </p:dialog>
            <p:dialog id="dlgStageDescription" widgetVar="dlgStageDescription" maximizable="true" height="800" width="100%">
                <p:panelGrid id="plgDescriptionDetail" styleClass="plgDetail Wid100" style="height:100%">
                    <f:facet name="header">
                        <p:row>
                            <p:column colspan="10">当前是"#{scorecardSetManagedBean.currentDetail.content}"的未达标原因分析及对策</p:column>
                        </p:row>
                    </f:facet>
                    <p:row style="text-align: center">
                        <p:column style="width: 8%"><p:outputLabel value="期间"/></p:column>
                        <p:column style="width: 23%;background-color: yellow">一阶原因（本单位可解决）</p:column>
                        <p:column style="width: 23%;background-color: yellow">对策</p:column>
                        <p:column style="width: 23%;background-color: #FF8F00">二阶原因（矩阵配合可解决）</p:column>
                        <p:column style="width: 23%;background-color: #FF8F00">对策</p:column>
                    </p:row>
                    <p:row>
                        <p:column style="width: 8%"><p:outputLabel value="Q1"/></p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="c1q1" value="#{scorecardSetManagedBean.currentDetail.causeScore1.q1}" rows="9" styleClass="Wid100" title="c1q1" />
                        </p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="s1q1" value="#{scorecardSetManagedBean.currentDetail.summaryScore1.q1}" rows="9" styleClass="Wid100" title="s1q1" />
                        </p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="c2q1" value="#{scorecardSetManagedBean.currentDetail.causeScore2.q1}" rows="9" styleClass="Wid100" title="c2q1" />
                        </p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="s2q1" value="#{scorecardSetManagedBean.currentDetail.summaryScore2.q1}" rows="9" styleClass="Wid100" title="s2q1" />
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column style="width: 8%"><p:outputLabel value="Q2"/></p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="c1q2" value="#{scorecardSetManagedBean.currentDetail.causeScore1.q2}" rows="9" styleClass="Wid100" title="c1q2" />
                        </p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="s1q2" value="#{scorecardSetManagedBean.currentDetail.summaryScore1.q2}" rows="9" styleClass="Wid100" title="s1q2" />
                        </p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="c2q2" value="#{scorecardSetManagedBean.currentDetail.causeScore2.q2}" rows="9" styleClass="Wid100" title="c2q2" />
                        </p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="s2q2" value="#{scorecardSetManagedBean.currentDetail.summaryScore2.q2}" rows="9" styleClass="Wid100" title="s2q2" />
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column style="width: 8%"><p:outputLabel value="Q3"/></p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="c1q3" value="#{scorecardSetManagedBean.currentDetail.causeScore1.q3}" rows="9" styleClass="Wid100" title="c1q3" />
                        </p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="s1q3" value="#{scorecardSetManagedBean.currentDetail.summaryScore1.q3}" rows="9" styleClass="Wid100" title="s1q3" />
                        </p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="c2q3" value="#{scorecardSetManagedBean.currentDetail.causeScore2.q3}" rows="9" styleClass="Wid100" title="c2q3" />
                        </p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="s2q3" value="#{scorecardSetManagedBean.currentDetail.summaryScore2.q3}" rows="9" styleClass="Wid100" title="s2q3" />
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column style="width: 8%"><p:outputLabel value="Q4"/></p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="c1q4" value="#{scorecardSetManagedBean.currentDetail.causeScore1.q4}" rows="9" styleClass="Wid100"  title="c1q4"/>
                        </p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="s1q4" value="#{scorecardSetManagedBean.currentDetail.summaryScore1.q4}" rows="9" styleClass="Wid100" title="s1q4"/>
                        </p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="c2q4" value="#{scorecardSetManagedBean.currentDetail.causeScore2.q4}" rows="9" styleClass="Wid100" title="c2q4"/>
                        </p:column>
                        <p:column style="width: 23%">
                            <p:inputTextarea id="s2q4" value="#{scorecardSetManagedBean.currentDetail.summaryScore2.q4}" rows="9" styleClass="Wid100" title="s2q4"/>
                        </p:column>
                    </p:row>
                    <f:facet name="footer">
                        <p:row>
                            <p:column colspan="10">
                                <p:commandButton id="btnScorecardexplanationScore"  actionListener="#{scorecardSetManagedBean.updateScorecardExplanationScore()}" icon="ui-icon-save" value="保存" style="float: right"
                                                 process="@this,formOne:dlgStageDescription" update="formOne:tabView" oncomplete="PF('dlgStageDescription').hide();" >
                                </p:commandButton>
                            </p:column>
                        </p:row>
                    </f:facet>
                </p:panelGrid>
            </p:dialog>
            <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
            </p:confirmDialog>
            <p:blockUI id="blockUI" block="formOne" trigger="btnSave,btnCalc">
                <p:graphicImage name="images/ajaxloadingbar.gif" library="ultima-layout"/>
            </p:blockUI>
        </h:form>
    </ui:define>
</ui:composition>
